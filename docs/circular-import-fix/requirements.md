# 循环导入修复需求文档

## 问题概述

当前应用存在关键的循环导入问题，导致`app/core/__init__.py`第5-6行的接口导入被迫注释。主要循环路径为：

```
app/config.py (第10行) 
→ 导入 app.core.interfaces.ConfigManagerInterface
→ app.core.dependency_injection.service_builder.py (第43行)
→ 导入 app.config.ConfigManager  
→ 回到 app/config.py (形成循环)
```

## 核心需求

### 需求1：消除配置层循环导入
**目标**：彻底切断config.py与core.interfaces之间的循环依赖
- 当config.py需要接口时，系统应从独立的基础设施层获取
- 当core层需要配置时，系统应通过抽象接口访问
- 当应用启动时，系统应无循环导入错误

### 需求2：建立基础设施层分离
**目标**：创建独立的基础设施层管理低级服务
- 配置管理应放置在基础设施层
- 基础设施层不依赖任何业务层
- 核心层通过抽象接口访问基础设施服务

### 需求3：重构依赖注入流程
**目标**：修复service_builder中的直接导入问题
- 服务构建器应通过工厂模式创建服务
- 移除对具体实现类的直接导入
- 保持现有分层初始化逻辑不变

### 需求4：恢复核心接口导入
**目标**：恢复`app/core/__init__.py`的完整功能
- 核心接口应能正常导入和导出
- 移除接口导入的注释行
- 验证无循环导入警告

## 非功能需求

### 简单性要求
- 修改涉及的文件数量不超过8个
- 新增代码文件不超过5个
- 单个文件代码行数控制在80行以内

### 兼容性要求
- 保持现有服务接口不变
- 现有业务逻辑无需修改
- 分层初始化顺序保持不变

### 性能要求
- 应用启动时间不增加
- 服务创建性能不下降
- 内存占用无显著增长