# 撤销重做功能修复和清除效果功能需求文档

## 介绍

本文档定义了修复现有撤销重做功能和添加清除主视图所有效果功能的需求。当前撤销重做功能无法正常工作，需要修复相关逻辑。同时需要在工具栏中添加清除效果按钮，允许用户一键清除主视图中应用的所有图像处理效果。

## 需求

### 需求 1：修复撤销重做功能

**用户故事：** 作为用户，我希望能够撤销和重做在主视图中应用的图像处理效果，以便在处理过程中可以回退到之前的状态。

#### 验收标准

1. 当用户应用图像处理效果后，撤销功能应该能够移除最近添加的效果
2. 当用户执行撤销操作后，重做功能应该能够重新应用被撤销的效果
3. 撤销和重做操作应该只影响主视图中的效果，不影响批处理作业中的效果
4. 当没有可撤销的操作时，撤销按钮应该被禁用
5. 当没有可重做的操作时，重做按钮应该被禁用
6. 撤销重做操作应该触发主视图的重新渲染

### 需求 2：添加清除所有效果功能

**用户故事：** 作为用户，我希望能够一键清除主视图中应用的所有图像处理效果，以便快速回到原始图像状态。

#### 验收标准

1. 工具栏中应该在"保存"按钮右边添加"清除效果"按钮
2. 编辑菜单中应该添加"清除所有效果"菜单项，快捷键为Ctrl+Shift+C
3. 当用户点击清除效果按钮时，主视图中的所有效果应该被清除
4. 清除效果操作应该支持撤销功能
5. 当主视图没有应用任何效果时，清除效果按钮应该被禁用
6. 清除效果操作应该只影响主视图，不影响批处理作业中的效果
7. 清除效果后应该触发主视图的重新渲染

### 需求 3：UI状态管理优化

**用户故事：** 作为用户，我希望界面能够根据当前状态智能地启用或禁用相关按钮，提供清晰的操作反馈。

#### 验收标准

1. 撤销按钮应该根据撤销栈状态动态启用/禁用
2. 重做按钮应该根据重做栈状态动态启用/禁用
3. 清除效果按钮应该根据当前是否有应用效果动态启用/禁用
4. 所有相关按钮都应该在没有加载图像时被禁用
5. 操作完成后应该显示适当的状态消息