# MainWindow重构需求文档

## 介绍

当前MainWindow类承担了过多职责，包括UI组装、信号连接、状态管理、事件处理等，导致代码复杂、难以维护。本重构旨在将MainWindow的职责分离，创建专门的组件来处理不同的关注点，使代码更加清晰、可维护。

## 需求

### 需求1：UI组装职责分离

**用户故事：** 作为开发者，我希望UI组装逻辑独立于MainWindow，以便更好地管理和维护界面布局。

#### 验收标准

1. WHEN 应用启动 THEN 系统 SHALL 通过专门的UI组装器创建界面布局
2. WHEN 需要修改布局 THEN 开发者 SHALL 只需修改UI组装器而不影响MainWindow
3. WHEN 批处理面板状态改变 THEN UI组装器 SHALL 自动调整布局结构

### 需求2：信号连接管理简化

**用户故事：** 作为开发者，我希望信号连接逻辑集中管理，以便减少MainWindow的复杂度。

#### 验收标准

1. WHEN 应用初始化 THEN 系统 SHALL 通过专门的连接管理器处理所有信号连接
2. WHEN 服务可用状态改变 THEN 连接管理器 SHALL 自动建立或断开相应连接
3. WHEN 需要添加新信号 THEN 开发者 SHALL 只需在连接管理器中配置

### 需求3：事件处理职责分离

**用户故事：** 作为开发者，我希望键盘和拖放事件处理逻辑独立，以便更好地管理用户交互。

#### 验收标准

1. WHEN 用户按下快捷键 THEN 专门的事件处理器 SHALL 处理键盘事件
2. WHEN 用户拖放文件 THEN 专门的事件处理器 SHALL 处理拖放操作
3. WHEN 需要添加新的交互方式 THEN 开发者 SHALL 只需扩展相应的事件处理器

### 需求4：服务依赖管理优化

**用户故事：** 作为开发者，我希望服务依赖关系清晰，避免MainWindow直接依赖过多服务。

#### 验收标准

1. WHEN MainWindow需要服务 THEN 系统 SHALL 通过依赖注入提供必要服务
2. WHEN 服务不可用 THEN 系统 SHALL 优雅处理而不崩溃
3. WHEN 服务状态改变 THEN 相关组件 SHALL 自动响应状态变化

### 需求5：初始化流程简化

**用户故事：** 作为开发者，我希望MainWindow的初始化流程简单清晰，避免复杂的分阶段初始化。

#### 验收标准

1. WHEN 应用启动 THEN MainWindow SHALL 通过简单的初始化流程完成设置
2. WHEN UI服务就绪 THEN 系统 SHALL 自动完成后续初始化而无需手动调用
3. WHEN 初始化失败 THEN 系统 SHALL 提供清晰的错误信息